{"ast":null,"code":"var _jsxFileName = \"/home/felipe/Arquivos/Kenzie/M3/react-entrega-s2-formulario-de-cadastro-felipemotavieira/src/context/UserContext.tsx\",\n    _s = $RefreshSig$();\n\nimport { useState, createContext, useEffect } from \"react\";\nimport api from \"../services/api\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const UserContext = /*#__PURE__*/createContext({});\n\nfunction UserProvider(_ref) {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  const [user, setUser] = useState({});\n  const [userId, setUserId] = useState({});\n  useEffect(() => {\n    let token = localStorage.getItem(\"@TOKEN\");\n    token ? api.get(\"/profile\", {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    }).then(response => {\n      setUser(response.data);\n    }).catch(error => {\n      console.log(error);\n    }) : localStorage.clear();\n  }, []);\n\n  const onSubmitRegister = async data => {\n    const response = await api.post(\"/users\", data).then(() => true).catch(() => false);\n    return response;\n  };\n\n  const onSubmitLogin = async data => {\n    const response = await api.post(\"/sessions\", data).then(response => {\n      console.log(response);\n      setUser(response.data.user);\n      localStorage.setItem(\"@TOKEN\", response.data.token);\n      localStorage.setItem(\"@USERID\", response.data.user.id);\n      setUserId(response.data.user.id);\n      return true;\n    }).catch(error => {\n      console.log(error);\n      return false;\n    });\n    console.log(response);\n    return response;\n  };\n\n  return /*#__PURE__*/_jsxDEV(UserContext.Provider, {\n    value: {\n      user,\n      userId,\n      onSubmitRegister,\n      onSubmitLogin\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 102,\n    columnNumber: 5\n  }, this);\n}\n\n_s(UserProvider, \"2wcdJmxNXF4duZd+3RfLYdY4JqY=\");\n\n_c = UserProvider;\nexport default UserProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"UserProvider\");","map":{"version":3,"names":["useState","createContext","useEffect","api","UserContext","UserProvider","children","user","setUser","userId","setUserId","token","localStorage","getItem","get","headers","Authorization","then","response","data","catch","error","console","log","clear","onSubmitRegister","post","onSubmitLogin","setItem","id"],"sources":["/home/felipe/Arquivos/Kenzie/M3/react-entrega-s2-formulario-de-cadastro-felipemotavieira/src/context/UserContext.tsx"],"sourcesContent":["import { useState, createContext, useEffect, ReactNode } from \"react\";\nimport api from \"../services/api\";\n\ninterface IUserProviderProps {\n  children: ReactNode;\n}\n\ninterface IUser {\n  id: string;\n  name: string;\n  email: string;\n  course_module: string;\n  bio: string;\n  contact: string;\n  created_at: string;\n  updated_at: string;\n  techs: Array<Object>;\n  works: Array<Object>;\n  avatar_url: string;\n}\n\ninterface IUserId {\n  id: string;\n}\n\ninterface ISubmitData {\n  email: string;\n  password: string;\n  name: string;\n  bio: string;\n  contact: string;\n  course_module: string;\n}\n\ninterface ILoginData {\n  email: string;\n  password: string;\n}\n\ninterface IUserProviderData {\n  user: IUser;\n  userId: IUserId;\n  onSubmitRegister: (data: ISubmitData) => Promise<boolean>;\n  onSubmitLogin: (data: ILoginData) => Promise<boolean>;\n}\n\nexport const UserContext = createContext<IUserProviderData>(\n  {} as IUserProviderData\n);\n\nfunction UserProvider({ children }: IUserProviderProps) {\n  const [user, setUser] = useState<IUser>({} as IUser);\n  const [userId, setUserId] = useState<IUserId>({} as IUserId);\n\n  useEffect(() => {\n    let token = localStorage.getItem(\"@TOKEN\");\n    token\n      ? api\n          .get(\"/profile\", {\n            headers: {\n              Authorization: `Bearer ${token}`,\n            },\n          })\n          .then((response) => {\n            setUser(response.data);\n          })\n          .catch((error) => {\n            console.log(error);\n          })\n      : localStorage.clear();\n  }, []);\n\n  const onSubmitRegister = async (data: ISubmitData | boolean) => {\n    const response = await api\n      .post(\"/users\", data)\n      .then(() => true)\n      .catch(() => false);\n\n    return response;\n  };\n\n  const onSubmitLogin = async (data: ILoginData | boolean) => {\n    const response = await api\n      .post(\"/sessions\", data)\n      .then((response) => {\n        console.log(response);\n        setUser(response.data.user);\n        localStorage.setItem(\"@TOKEN\", response.data.token);\n        localStorage.setItem(\"@USERID\", response.data.user.id);\n        setUserId(response.data.user.id);\n        return true;\n      })\n      .catch((error) => {\n        console.log(error);\n        return false;\n      });\n    console.log(response);\n    return response;\n  };\n\n  return (\n    <UserContext.Provider\n      value={{ user, userId, onSubmitRegister, onSubmitLogin }}\n    >\n      {children}\n    </UserContext.Provider>\n  );\n}\n\nexport default UserProvider;\n"],"mappings":";;;AAAA,SAASA,QAAT,EAAmBC,aAAnB,EAAkCC,SAAlC,QAA8D,OAA9D;AACA,OAAOC,GAAP,MAAgB,iBAAhB;;AA6CA,OAAO,MAAMC,WAAW,gBAAGH,aAAa,CACtC,EADsC,CAAjC;;AAIP,SAASI,YAAT,OAAwD;EAAA;;EAAA,IAAlC;IAAEC;EAAF,CAAkC;EACtD,MAAM,CAACC,IAAD,EAAOC,OAAP,IAAkBR,QAAQ,CAAQ,EAAR,CAAhC;EACA,MAAM,CAACS,MAAD,EAASC,SAAT,IAAsBV,QAAQ,CAAU,EAAV,CAApC;EAEAE,SAAS,CAAC,MAAM;IACd,IAAIS,KAAK,GAAGC,YAAY,CAACC,OAAb,CAAqB,QAArB,CAAZ;IACAF,KAAK,GACDR,GAAG,CACAW,GADH,CACO,UADP,EACmB;MACfC,OAAO,EAAE;QACPC,aAAa,EAAG,UAASL,KAAM;MADxB;IADM,CADnB,EAMGM,IANH,CAMSC,QAAD,IAAc;MAClBV,OAAO,CAACU,QAAQ,CAACC,IAAV,CAAP;IACD,CARH,EASGC,KATH,CASUC,KAAD,IAAW;MAChBC,OAAO,CAACC,GAAR,CAAYF,KAAZ;IACD,CAXH,CADC,GAaDT,YAAY,CAACY,KAAb,EAbJ;EAcD,CAhBQ,EAgBN,EAhBM,CAAT;;EAkBA,MAAMC,gBAAgB,GAAG,MAAON,IAAP,IAAuC;IAC9D,MAAMD,QAAQ,GAAG,MAAMf,GAAG,CACvBuB,IADoB,CACf,QADe,EACLP,IADK,EAEpBF,IAFoB,CAEf,MAAM,IAFS,EAGpBG,KAHoB,CAGd,MAAM,KAHQ,CAAvB;IAKA,OAAOF,QAAP;EACD,CAPD;;EASA,MAAMS,aAAa,GAAG,MAAOR,IAAP,IAAsC;IAC1D,MAAMD,QAAQ,GAAG,MAAMf,GAAG,CACvBuB,IADoB,CACf,WADe,EACFP,IADE,EAEpBF,IAFoB,CAEdC,QAAD,IAAc;MAClBI,OAAO,CAACC,GAAR,CAAYL,QAAZ;MACAV,OAAO,CAACU,QAAQ,CAACC,IAAT,CAAcZ,IAAf,CAAP;MACAK,YAAY,CAACgB,OAAb,CAAqB,QAArB,EAA+BV,QAAQ,CAACC,IAAT,CAAcR,KAA7C;MACAC,YAAY,CAACgB,OAAb,CAAqB,SAArB,EAAgCV,QAAQ,CAACC,IAAT,CAAcZ,IAAd,CAAmBsB,EAAnD;MACAnB,SAAS,CAACQ,QAAQ,CAACC,IAAT,CAAcZ,IAAd,CAAmBsB,EAApB,CAAT;MACA,OAAO,IAAP;IACD,CAToB,EAUpBT,KAVoB,CAUbC,KAAD,IAAW;MAChBC,OAAO,CAACC,GAAR,CAAYF,KAAZ;MACA,OAAO,KAAP;IACD,CAboB,CAAvB;IAcAC,OAAO,CAACC,GAAR,CAAYL,QAAZ;IACA,OAAOA,QAAP;EACD,CAjBD;;EAmBA,oBACE,QAAC,WAAD,CAAa,QAAb;IACE,KAAK,EAAE;MAAEX,IAAF;MAAQE,MAAR;MAAgBgB,gBAAhB;MAAkCE;IAAlC,CADT;IAAA,UAGGrB;EAHH;IAAA;IAAA;IAAA;EAAA,QADF;AAOD;;GAzDQD,Y;;KAAAA,Y;AA2DT,eAAeA,YAAf"},"metadata":{},"sourceType":"module"}